function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function _createClass(e,n,o){return n&&_defineProperties(e.prototype,n),o&&_defineProperties(e,o),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"ct+p":function(e,n,o){"use strict";o.r(n),o.d(n,"HomePageModule",(function(){return b}));var t=o("ofXK"),r=o("TEn/"),i=o("3Pt+"),l=o("tyNb"),a=o("fXoL");function c(e,n){if(1&e){var o=a.Nb();a.Mb(0,"div"),a.Mb(1,"ion-button",10),a.Ub("click",(function(){return a.cc(o),a.Wb().onClickCall()})),a.hc(2," Call "),a.Lb(),a.Lb()}}function s(e,n){if(1&e){var o=a.Nb();a.Mb(0,"ion-button",11),a.Ub("click",(function(){return a.cc(o),a.Wb().onClickHangUp()})),a.hc(1," HangUp "),a.Lb()}}var u,d,p,m=[{path:"",component:(u=function(){function e(n,o,t){var r=this;_classCallCheck(this,e),this.renderer=n,this.elementRef=o,this.platform=t,this.ua=null,this.connectedSession=null,this.currentCall=null,this.localStream=null,this.remoteStream=null,this.setCallListeners=function(){r.currentCall.on("localStreamAvailable",(function(e){console.log("localStreamAvailable",e),r.localStream=e,e.addInDiv("local-stream","local-media",{height:"150px"},!1)})).on("streamAdded",(function(e){console.log("streamAdded :",e),r.remoteStream=e,e.addInDiv("remote-stream","remote-media",{height:"150px"},!1)})).on("streamRemoved",(function(e){e.removeFromDiv("remote-stream","remote-media"),r.remoteStream=null})).on("userMediaError",(function(e){console.error("userMediaError detected : ",e),console.error("userMediaError detected with error : ",e.error)})).on("hangup",(function(){r.clearStreams(),r.currentCall=null,r.onCall=!1}))},this.onClickCall=function(){if(r.opponentId)if(r.onCall)console.warn("Call is already started");else{var e=r.connectedSession.getOrCreateContact(r.opponentId).call();e?(r.currentCall=e,r.setCallListeners(),r.onCall=!0):console.warn("Cannot establish the call")}else console.warn("Opponent number is null")},this.onClickHangUp=function(){r.clearStreams(),r.currentCall.hangUp(),r.currentCall=null,r.onCall=!1},this.checkPermissions=function(){cordova.plugins.diagnostic.requestRuntimePermissions((function(e){console.log("Permissions statuses: ",e)}),(function(e){console.error("The following error occurred: ",e)}),[cordova.plugins.diagnostic.permission.CAMERA,cordova.plugins.diagnostic.permission.RECORD_AUDIO])},this.clearStreams=function(){r.localStream&&r.localStream.removeFromDiv("local-stream","local-media"),r.remoteStream&&r.remoteStream.removeFromDiv("remote-stream","remote-media"),r.localStream=null,r.remoteStream=null},this.onCall=!1,this.infoLabel="Initializing...",this.platform.ready().then((function(){r.platform.is("ios")&&cordova.plugins.iosrtc.registerGlobals();var e=r.renderer.createElement("script");e.src="https://cloud.apizee.com/apiRTC/apiRTC-latest.min.js",e.onload=function(){console.log("apiRTC loaded"),r.startApp()},r.renderer.appendChild(r.elementRef.nativeElement,e)}))}return _createClass(e,[{key:"startApp",value:function(){var e=this;console.log("startApp"),apiRTC.setLogLevel(10),this.ua=new apiRTC.UserAgent({uri:"apzkey:myDemoApiKey"}),this.ua.register({cloudUrl:"https://cloud.apizee.com"}).then((function(n){console.log("User registered with session: ",n),n.on("contactListUpdate",(function(e){console.log("contactListUpdate",e)})).on("incomingCall",(function(n){n.accept().then((function(n){e.currentCall=n,e.setCallListeners(),e.onCall=!0}))})),e.connectedSession=n,e.infoLabel="Your id: "+n.getId()})).catch((function(e){console.error("User agent registration failed",e)})),this.checkPermissions()}}]),e}(),u.\u0275fac=function(e){return new(e||u)(a.Jb(a.D),a.Jb(a.l),a.Jb(r.n))},u.\u0275cmp=a.Db({type:u,selectors:[["app-home"]],decls:18,vars:6,consts:[[3,"translucent"],[2,"height","15px"],[3,"fullscreen"],["color","primary"],[2,"height","80px","padding","20px 0"],["placeholder","Enter number",3,"ngModel","ngModelChange"],[4,"ngIf","ngIfElse"],["hangupButton",""],["id","local-stream"],["id","remote-stream"],["color","primary",3,"click"],["color","danger",3,"click"]],template:function(e,n){if(1&e&&(a.Mb(0,"ion-header",0),a.Mb(1,"ion-toolbar"),a.Mb(2,"ion-title"),a.hc(3," P2P call sample "),a.Lb(),a.Lb(),a.Lb(),a.Kb(4,"ion-row",1),a.Mb(5,"ion-content",2),a.Mb(6,"ion-grid"),a.Mb(7,"ion-row"),a.Mb(8,"ion-label",3),a.hc(9),a.Lb(),a.Lb(),a.Mb(10,"ion-row",4),a.Mb(11,"ion-input",5),a.Ub("ngModelChange",(function(e){return n.opponentId=e})),a.Lb(),a.Lb(),a.Mb(12,"ion-row"),a.fc(13,c,3,0,"div",6),a.fc(14,s,2,0,"ng-template",null,7,a.gc),a.Lb(),a.Kb(16,"ion-row",8),a.Kb(17,"ion-row",9),a.Lb(),a.Lb()),2&e){var o=a.bc(15);a.Zb("translucent",!0),a.zb(5),a.Zb("fullscreen",!0),a.zb(4),a.ic(" ",n.infoLabel," "),a.zb(2),a.Zb("ngModel",n.opponentId),a.zb(2),a.Zb("ngIf",!n.onCall)("ngIfElse",o)}},directives:[r.e,r.k,r.j,r.i,r.c,r.d,r.g,r.f,r.o,i.d,i.e,t.h,r.b],styles:["#container[_ngcontent-%COMP%]{text-align:center;background:red;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}ion-input[_ngcontent-%COMP%]{border:1px solid #3880ff}"]}),u)}],f=((p=function e(){_classCallCheck(this,e)}).\u0275mod=a.Hb({type:p}),p.\u0275inj=a.Gb({factory:function(e){return new(e||p)},imports:[[l.i.forChild(m)],l.i]}),p),b=((d=function e(){_classCallCheck(this,e)}).\u0275mod=a.Hb({type:d}),d.\u0275inj=a.Gb({factory:function(e){return new(e||d)},imports:[[t.b,i.a,r.l,f]]}),d)}}]);